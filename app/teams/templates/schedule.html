{% extends "base.html" %}
{% block title %}{{ team.school.school_name }} {{ team.sport.name }} Schedule{% endblock %}
{% block content %}
<header class="bg-dark-body">
    <div>
        <img src="{{ url_for('schools.static', filename='images/all_schools_banner.webp') }}"
             alt="{{ team.sport.name }} Banner"
             class="img-fluid"
             style="height: 170px; width: 100%; object-fit: cover;">
    </div>
</header>

<main class="bg-dark-body" style="min-height: 100vh; padding-top: 10px;">
    <div class="container text-light">
        <h1 class="text-center">{{ team.school.school_name }} {{ team.sport.name }} Schedule</h1>
        <p class="text-center">Season: {{ season.start.strftime("%B %d, %Y") }} - {{ season.end.strftime("%B %d, %Y") }}</p>

        <!-- Team Record -->
        <p class="text-center">Record:
            <span>{{ record.wins }} Wins</span>,
            <span>{{ record.losses }} Losses</span>
        </p>

        <table class="table table-dark table-striped mt-4">
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Opponent</th>
                    <th>Opponent Level</th>
                    <th>Result</th>
                    <th>Score</th>
                    <th>Game Details</th>
                </tr>
            </thead>
            <tbody>
                {% for game in schedule %}
                <tr>
                    <td>{{ game.date.strftime("%B %d, %Y") }}</td>
                    <td>
                        {% if game.home_team_id == team.id %}
                            {{ game.away_team.school.school_name }}
                        {% else %}
                            {{ game.home_team.school.school_name }}
                        {% endif %}
                    </td>
                    <td>
                        {% if game.home_team_id == team.id %}
                            {{ game.away_team.grade_level }} {{ game.away_team.gender }}
                        {% else %}
                            {{ game.home_team.grade_level }} {{ game.home_team.gender }}
                        {% endif %}
                    </td>
                    <td>
                        {% if game.home_team_id == team.id and game.home_score > game.away_score or
                              game.away_team_id == team.id and game.away_score > game.home_score %}
                            <span class="text-success">Win</span>
                        {% else %}
                            <span class="text-danger">Loss</span>
                        {% endif %}
                    </td>
                    <td>
                        {% if game.home_team_id == team.id %}
                            {{ game.home_score }} - {{ game.away_score }}
                        {% else %}
                            {{ game.away_score }} - {{ game.home_score }}
                        {% endif %}
                    </td>
                    <td>
                        <a href="{{ url_for('teams.game_details', game_id=game.id) }}" class="btn btn-primary">
                            View Details
                        </a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</main>
{% endblock %}
